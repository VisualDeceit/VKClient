//
//  UserPhoto.swift
//  VkClient
//
//  Created by Alexander Fomin on 23.01.2021.
//

/*
 {
     "response": {
         "count": 219,
         "items": [
             {
                 "album_id": -6,
                 "date": 1599065760,
                 "id": 457239764,
                 "owner_id": 246569525,
                 "has_tags": false,
                 "post_id": 1154,
                 "sizes": [
                     {
                         "height": 130,
                         "url": "https://sun9-11.userapi.com/impg/OOdUgUxJLokDo1obmRjm3k72o_M9DKhbW-L2xg/bRPg_62bo_0.jpg?size=87x130&quality=96&sign=d2b0460f6c571105f0c688aff3d64e14&c_uniq_tag=o8QdjqDuzY1qDNIOyfs2E2t569OZrwpucitbSbgA_xw&type=album",
                         "type": "m",
                         "width": 87
                     },
                     {
                         "height": 195,
                         "url": "https://sun9-11.userapi.com/impg/OOdUgUxJLokDo1obmRjm3k72o_M9DKhbW-L2xg/bRPg_62bo_0.jpg?size=130x195&quality=96&sign=65c633bca941215e9375354035a5c6ac&c_uniq_tag=58aZWUma8BbWaWXFdC1UGNce_lOBSFbI2p34yxHpC2g&type=album",
                         "type": "o",
                         "width": 130
                     },
                     {
                         "height": 300,
                         "url": "https://sun9-11.userapi.com/impg/OOdUgUxJLokDo1obmRjm3k72o_M9DKhbW-L2xg/bRPg_62bo_0.jpg?size=200x300&quality=96&sign=1f5ee8903e4984bb3e55a5a8caa091b3&c_uniq_tag=Sph-pSpFVRUeiqDduLzfHyuQvQquGqm9_p43hXsjh9A&type=album",
                         "type": "p",
                         "width": 200
                     },
                     {
                         "height": 480,
                         "url": "https://sun9-11.userapi.com/impg/OOdUgUxJLokDo1obmRjm3k72o_M9DKhbW-L2xg/bRPg_62bo_0.jpg?size=320x480&quality=96&sign=25841301fba1f785f3d1cbb39e3a6eca&c_uniq_tag=b6_AQWG0rYC_pkTRxSGstJdBG8Dx1su6cc5lW3CR43Q&type=album",
                         "type": "q",
                         "width": 320
                     },
                     {
                         "height": 765,
                         "url": "https://sun9-11.userapi.com/impg/OOdUgUxJLokDo1obmRjm3k72o_M9DKhbW-L2xg/bRPg_62bo_0.jpg?size=510x765&quality=96&sign=935efa1b0d7e326c6b8affad7a69910b&c_uniq_tag=IzgybzBUMgIa17eZEH28WSiZI7Tycma5ycb3rNc0RHo&type=album",
                         "type": "r",
                         "width": 510
                     },
                     {
                         "height": 75,
                         "url": "https://sun9-11.userapi.com/impg/OOdUgUxJLokDo1obmRjm3k72o_M9DKhbW-L2xg/bRPg_62bo_0.jpg?size=50x75&quality=96&sign=390c1285aed2e8c74a4c06a304f0a96b&c_uniq_tag=U0LfyckUHtwwYiX6iA7YBed6UeNVYtWKV5Su5z5J5ps&type=album",
                         "type": "s",
                         "width": 50
                     },
                     {
                         "height": 2000,
                         "url": "https://sun9-11.userapi.com/impg/OOdUgUxJLokDo1obmRjm3k72o_M9DKhbW-L2xg/bRPg_62bo_0.jpg?size=1333x2000&quality=96&proxy=1&sign=22efd3d6512331ba05bbad6f20b75537&c_uniq_tag=nz05LxgWndDWqz6s8R2ACyfpiNVU7uzX5A9L-aDj94k&type=album",
                         "type": "w",
                         "width": 1333
                     },
                     {
                         "height": 604,
                         "url": "https://sun9-11.userapi.com/impg/OOdUgUxJLokDo1obmRjm3k72o_M9DKhbW-L2xg/bRPg_62bo_0.jpg?size=403x604&quality=96&sign=325a419091fd49d67597447bf196eff7&c_uniq_tag=07F7T31sFHa-AQffrcufz6rmWP0li7ZOqlT0wTvsFtg&type=album",
                         "type": "x",
                         "width": 403
                     },
                     {
                         "height": 807,
                         "url": "https://sun9-11.userapi.com/impg/OOdUgUxJLokDo1obmRjm3k72o_M9DKhbW-L2xg/bRPg_62bo_0.jpg?size=538x807&quality=96&sign=fe6aef08d81ea072cc1d568957377ea6&c_uniq_tag=OGyPTJFF5doMi2tcDyt8AS3UI1QshvsRGbJsllh54rU&type=album",
                         "type": "y",
                         "width": 538
                     },
                     {
                         "height": 1080,
                         "url": "https://sun9-11.userapi.com/impg/OOdUgUxJLokDo1obmRjm3k72o_M9DKhbW-L2xg/bRPg_62bo_0.jpg?size=720x1080&quality=96&sign=d3434fc0fea3c1fea7240d9ff03202c2&c_uniq_tag=_fbgBqpA6cfYX7dzQ_jwCx8Z68W48wkd0psTF17yOG4&type=album",
                         "type": "z",
                         "width": 720
                     }
                 ],
                 "text": "",
                 "likes": {
                     "user_likes": 0,
                     "count": 58
                 },
                 "reposts": {
                     "count": 0
                 }
             }
         ]
     }
 }
 
 */

import Foundation

struct UserPhotoModel: Decodable {
    let response: UserPhotoResponse
    
    enum CodingKeys: String, CodingKey {
        case response
    }
}

struct UserPhotoResponse: Decodable {
    let items: [UserPhoto]
    
    enum CodingKeys: String, CodingKey {
        case items
    }
}

struct UserPhoto: Decodable {
    let likesCount: Int
    let isLiked: Int
    let repostsCount: Int
    let sizes: [PhotoSize]
    
    enum RepostsCodingKeys: String, CodingKey{
        case repostsCount = "count"
    }
    
    enum LikesCodingKeys: String, CodingKey {
        case likesCount = "count"
        case isLiked = "user_likes"
    }
    
    enum CodingKeys: String, CodingKey {
        case likesCount
        case isLiked
        case repostsCount
        case sizes
        case likes
        case reposts
    }
      
    init(from decoder: Decoder) throws {
        let container = try decoder.container(keyedBy: CodingKeys.self)
        self.sizes = try container.decode([PhotoSize].self, forKey: .sizes)
        
        let likeContainer = try container.nestedContainer(keyedBy: LikesCodingKeys.self, forKey: .likes)
        self.isLiked = try likeContainer.decode(Int.self, forKey: .isLiked)
        self.likesCount = try likeContainer.decode(Int.self, forKey: .likesCount)
        
        let repostsContainer = try container.nestedContainer(keyedBy: RepostsCodingKeys.self, forKey: .reposts)
        self.repostsCount = try repostsContainer.decode(Int.self, forKey: .repostsCount)
    }
}

//struct Likes: Decodable {
//    let count: Int
//    let isLiked: Int
//
//    enum CodingKeys: String, CodingKey {
//        case count
//        case isLiked = "user_likes"
//    }
//}

struct PhotoSize: Decodable {
    let height: Int
    let width: Int
    let url: String
}

